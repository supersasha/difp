import numpy as np
from scipy.interpolate import CubicSpline

SPECTRE_SIZE = 65

STATUS_A = np.array([
    [-10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, 0.997467, 2.568000, 3.812504, 4.638000,
        4.896029, 5.000000, 4.957244, 4.871000, 4.752040, 4.604000, 4.452305,
        4.286000, 4.095232, 3.900000, 3.725500, 3.551000, 3.360616, 3.165000,
        2.970937, 2.776000, 2.580001, 2.383000],
    [-10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, 0.590581, 1.650000, 2.803982, 3.822000,
        4.424023, 4.782000, 4.935414, 5.000000, 4.970295, 4.906000, 4.798153,
        4.644000, 4.454583, 4.221000, 3.941115, 3.609000, 3.222086, 2.766000,
        2.218671, 1.579000, 0.620097, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0],
    [-10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 1.573586,
        3.602000, 4.398523, 4.819000, 4.948891, 5.000000, 4.972905, 4.912000,
        4.797650, 4.620000, 4.374881, 4.040000, 3.572193, 2.989000, 2.302860,
        1.566000, 0.725914, 0.165000, 0.045596, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0,
        -10.0, -10.0, -10.0, -10.0, -10.0]
])

STATUS_M = np.array([
    [-60.291000, -58.991000, -57.691000, -56.391000, -55.091000, -53.791000,
     -52.491000, -51.191000, -49.891000, -48.591000, -47.291000, -45.991000,
     -44.691000, -43.391000, -42.091000, -40.791000, -39.491000, -38.191000,
     -36.891000, -35.591000, -34.291000, -32.991000, -31.691000, -30.391000,
     -29.091000, -27.791000, -26.491000, -25.191000, -23.891000, -22.591000,
     -21.291000, -19.991000, -18.691000, -17.391000, -16.091000, -14.791000,
     -13.491000, -12.191000, -10.891000,  -9.591000,  -8.291000,  -6.991000,
      -5.691000,  -4.391000,  -3.091000,  -1.791000,  -0.491000,   0.824040,
       2.109000,   3.497183,   4.479000,   4.846277,   5.000000,   4.968707,
       4.899000,   4.759728,   4.578000,   4.418271,   4.252000,   4.067352,
       3.875000,   3.683936,   3.491000,   3.296005,   3.099000 ],
    [ -8.388000,  -7.858000,  -7.328000,  -6.798000,  -6.268000,  -5.738000,
      -5.208000,  -4.678000,  -4.148000,  -3.618000,  -3.088000,  -2.558000,
      -2.028000,  -1.498000,  -0.968000,  -0.438000,   0.092000,   0.622313,
       1.152000,   1.686787,   2.207000,   2.710133,   3.156000,   3.508331,
       3.804000,   4.055549,   4.272000,   4.463102,   4.626000,   4.764237,
       4.872000,   4.957048,   5.000000,   4.998716,   4.995000,   4.934949,
       4.818000,   4.662455,   4.458000,   4.210811,   3.915000,   3.568473,
       3.172000,   2.731815,   2.239000,   1.672818,   1.070000,   0.471963,
      -0.130000,  -0.730000,  -1.330000,  -1.930000,  -2.530000,  -3.130000,
      -3.730000,  -4.330000,  -4.930000,  -5.530000,  -6.130000,  -6.730000,
      -7.330000,  -7.930000,  -8.530000,  -9.130000,  -9.730000 ],
    [ -5.397000,  -4.147000,  -2.897000,  -1.647000,  -0.397000,   0.887106,
       2.103000,   3.281977,   4.111000,   4.433957,   4.632000,   4.771515,
       4.871000,   4.956445,   5.000000,   4.986780,   4.955000,   4.874360,
       4.743000,   4.568359,   4.343000,   4.066481,   3.743000,   3.396307,
       2.990000,   2.495219,   1.852000,   0.839493,  -0.348000,  -1.448000,
      -2.548000,  -3.648000,  -4.748000,  -5.848000,  -6.948000,  -8.048000,
      -9.148000, -10.248000, -11.348000, -12.448000, -13.548000, -14.648000,
     -15.748000, -16.848000, -17.948000, -19.048000, -20.148000, -21.248000,
     -22.348000, -23.465978, -24.548000, -25.499164, -26.478000, -27.692959,
     -28.948000, -30.063899, -31.148000, -32.248000, -33.348000, -34.448000,
     -35.548000, -36.648000, -37.748000, -38.848000, -39.948000 ]
])

ILLUM_A = np.array([9.7951,10.8996,12.0853,13.3543,14.708,16.148,17.6753,19.2907,
    20.995,22.7883,24.6709,26.6425,28.7027,30.8508,33.0859,35.4068,37.8121,
    40.3002,42.8693,45.5174,48.2423,51.0418,53.9132,56.8539,59.8611,62.932,
    66.0635,69.2525,72.4959,75.7903,79.1326,82.5193,85.947,89.4124,92.912,
    96.4423,100,103.582,107.184,110.803,114.436,118.08,121.731,125.386,
    129.043,132.697,136.346,139.988,143.618,147.235,150.836,154.418,157.979,
    161.516,165.028,168.51,171.963,175.383,178.769,182.118,185.429,188.701,
    191.931,195.118,198.261])

D_S0 = np.array([63.40, 64.60, 65.80, 80.30, 94.80, 99.80, 104.80, 105.35, 105.90,
    101.35, 96.80, 105.35, 113.90, 119.75, 125.60, 125.55, 125.50,
    123.40, 121.30, 121.30, 121.30, 117.40, 113.50, 113.30, 113.10,
    111.95, 110.80, 108.65, 106.50, 107.65, 108.80, 107.05, 105.30,
    104.85, 104.40, 102.20, 100.00, 98.00, 96.00, 95.55, 95.10, 92.10,
    89.10, 89.80, 90.50, 90.40, 90.30, 89.35, 88.40, 86.20, 84.00,
    84.55, 85.10, 83.50, 81.90, 82.25, 82.60, 83.75, 84.90, 83.10,
    81.30, 76.60, 71.90, 73.10, 74.30])

D_S1 = np.array([38.50, 36.75, 35.00, 39.20, 43.40, 44.85, 46.30, 45.10, 43.90,
    40.50, 37.10, 36.90, 36.70, 36.30, 35.90, 34.25, 32.60, 30.25,
    27.90, 26.10, 24.30, 22.20, 20.10, 18.15, 16.20, 14.70, 13.20,
    10.90, 8.60, 7.35, 6.10, 5.15, 4.20, 3.05, 1.90, 0.95, 0.00,
    -0.80, -1.60, -2.55, -3.50, -3.50, -3.50, -4.65, -5.80, -6.50,
    -7.20, -7.90, -8.60, -9.05, -9.50, -10.20, -10.90, -10.80, -10.70,
    -11.35, -12.00, -13.00, -14.00, -13.80, -13.60, -12.80, -12.00,
    -12.65, -13.30])

D_S2 = np.array([3.00, 2.10, 1.20, 0.05, -1.10, -0.80, -0.50, -0.60, -0.70, -0.95,
    -1.20, -1.90, -2.60, -2.75, -2.90, -2.85, -2.80, -2.70, -2.60,
    -2.60, -2.60, -2.20, -1.80, -1.65, -1.50, -1.40, -1.30, -1.25,
    -1.20, -1.10, -1.00, -0.75, -0.50, -0.40, -0.30, -0.15, 0.00,
    0.10, 0.20, 0.35, 0.50, 1.30, 2.10, 2.65, 3.20, 3.65, 4.10, 4.40,
    4.70, 4.90, 5.10, 5.90, 6.70, 7.00, 7.30, 7.95, 8.60, 9.20, 9.80,
    10.00, 10.20, 9.25, 8.30, 8.95, 9.60])

V = np.array([0, 0, 4.1276E-04, 1.0561E-03, 2.4477E-03, 4.9696E-03, 9.0909E-03,
    1.4360E-02, 2.0443E-02, 2.6457E-02, 3.3752E-02, 4.2453E-02, 5.1540E-02,
    5.8947E-02, 6.6538E-02, 7.4472E-02, 8.7660E-02, 1.0913E-01, 1.3362E-01,
    1.5773E-01, 1.8348E-01, 2.1158E-01, 2.4342E-01, 2.9118E-01, 3.5522E-01,
    4.3550E-01, 5.2907E-01, 6.2979E-01, 7.2759E-01, 8.0387E-01, 8.6611E-01,
    9.1467E-01, 9.6067E-01, 9.8593E-01, 9.9160E-01, 9.9987E-01, 9.9460E-01,
    9.8535E-01, 9.6525E-01, 9.3132E-01, 8.8215E-01, 8.4131E-01, 7.9168E-01,
    7.3264E-01, 6.6879E-01, 6.0338E-01, 5.3516E-01, 4.6755E-01, 4.0263E-01,
    3.4256E-01, 2.8231E-01, 2.2848E-01, 1.8338E-01, 1.4581E-01, 1.1233E-01,
    8.4474E-02, 6.2710E-02, 4.6031E-02, 3.3432E-02, 2.3981E-02, 1.6971E-02,
    1.1841E-02, 8.1286E-03, 5.6566E-03, 3.9376E-03])

A_1931_64_400_700_10nm = np.array([
    [ 0.0191097, 0.0020044, 0.0860109 ],
    [ 0.084736, 0.008756, 0.389366 ],
    [ 0.204492, 0.021391, 0.972542 ],
    [ 0.314679, 0.038676, 1.55348 ],
    [ 0.383734, 0.062077, 1.96728 ],
    [ 0.370702, 0.089456, 1.9948 ],
    [ 0.302273, 0.128201, 1.74537 ],
    [ 0.195618, 0.18519, 1.31756 ],
    [ 0.080507, 0.253589, 0.772125 ],
    [ 0.016172, 0.339133, 0.415254 ],
    [ 0.003816, 0.460777, 0.218502 ],
    [ 0.037465, 0.606741, 0.112044 ],
    [ 0.117749, 0.761757, 0.060709 ],
    [ 0.236491, 0.875211, 0.030451 ],
    [ 0.376772, 0.961988, 0.013676 ],
    [ 0.529826, 0.991761, 0.003988 ],
    [ 0.705224, 0.99734, 0 ],
    [ 0.878655, 0.955552, 0 ],
    [ 1.01416, 0.868934, 0 ],
    [ 1.11852, 0.777405, 0 ],
    [ 1.12399, 0.658341, 0 ],
    [ 1.03048, 0.527963, 0 ],
    [ 0.856297, 0.398057, 0 ],
    [ 0.647467, 0.283493, 0 ],
    [ 0.431567, 0.179828, 0 ],
    [ 0.268329, 0.107633, 0 ],
    [ 0.152568, 0.060281, 0 ],
    [ 0.0812606, 0.0318004, 0 ],
    [ 0.0408508, 0.0159051, 0 ],
    [ 0.0199413, 0.0077488, 0 ],
    [ 0.00957688, 0.00371774, 0 ]
])

A1931_78 = np.array([
    [2.689900e-003, 2.000000e-004, 1.226000e-002],
    [5.310500e-003, 3.955600e-004, 2.422200e-002],
    [1.078100e-002, 8.000000e-004, 4.925000e-002],
    [2.079200e-002, 1.545700e-003, 9.513500e-002],
    [3.798100e-002, 2.800000e-003, 1.740900e-001],
    [6.315700e-002, 4.656200e-003, 2.901300e-001],
    [9.994100e-002, 7.400000e-003, 4.605300e-001],
    [1.582400e-001, 1.177900e-002, 7.316600e-001],
    [2.294800e-001, 1.750000e-002, 1.065800e+000],
    [2.810800e-001, 2.267800e-002, 1.314600e+000],
    [3.109500e-001, 2.730000e-002, 1.467200e+000],
    [3.307200e-001, 3.258400e-002, 1.579600e+000],
    [3.333600e-001, 3.790000e-002, 1.616600e+000],
    [3.167200e-001, 4.239100e-002, 1.568200e+000],
    [2.888200e-001, 4.680000e-002, 1.471700e+000],
    [2.596900e-001, 5.212200e-002, 1.374000e+000],
    [2.327600e-001, 6.000000e-002, 1.291700e+000],
    [2.099900e-001, 7.294200e-002, 1.235600e+000],
    [1.747600e-001, 9.098000e-002, 1.113800e+000],
    [1.328700e-001, 1.128400e-001, 9.422000e-001],
    [9.194400e-002, 1.390200e-001, 7.559600e-001],
    [5.698500e-002, 1.698700e-001, 5.864000e-001],
    [3.173100e-002, 2.080200e-001, 4.466900e-001],
    [1.461300e-002, 2.580800e-001, 3.411600e-001],
    [4.849100e-003, 3.230000e-001, 2.643700e-001],
    [2.321500e-003, 4.054000e-001, 2.059400e-001],
    [9.289900e-003, 5.030000e-001, 1.544500e-001],
    [2.927800e-002, 6.081100e-001, 1.091800e-001],
    [6.379100e-002, 7.100000e-001, 7.658500e-002],
    [1.108100e-001, 7.951000e-001, 5.622700e-002],
    [1.669200e-001, 8.620000e-001, 4.136600e-002],
    [2.276800e-001, 9.150500e-001, 2.935300e-002],
    [2.926900e-001, 9.540000e-001, 2.004200e-002],
    [3.622500e-001, 9.800400e-001, 1.331200e-002],
    [4.363500e-001, 9.949500e-001, 8.782300e-003],
    [5.151300e-001, 1.000100e+000, 5.857300e-003],
    [5.974800e-001, 9.950000e-001, 4.049300e-003],
    [6.812100e-001, 9.787500e-001, 2.921700e-003],
    [7.642500e-001, 9.520000e-001, 2.277100e-003],
    [8.439400e-001, 9.155800e-001, 1.970600e-003],
    [9.163500e-001, 8.700000e-001, 1.806600e-003],
    [9.770300e-001, 8.162300e-001, 1.544900e-003],
    [1.023000e+000, 7.570000e-001, 1.234800e-003],
    [1.051300e+000, 6.948300e-001, 1.117700e-003],
    [1.055000e+000, 6.310000e-001, 9.056400e-004],
    [1.036200e+000, 5.665400e-001, 6.946700e-004],
    [9.923900e-001, 5.030000e-001, 4.288500e-004],
    [9.286100e-001, 4.417200e-001, 3.181700e-004],
    [8.434600e-001, 3.810000e-001, 2.559800e-004],
    [7.398300e-001, 3.205200e-001, 1.567900e-004],
    [6.328900e-001, 2.650000e-001, 9.769400e-005],
    [5.335100e-001, 2.170200e-001, 6.894400e-005],
    [4.406200e-001, 1.750000e-001, 5.116500e-005],
    [3.545300e-001, 1.381200e-001, 3.601600e-005],
    [2.786200e-001, 1.070000e-001, 2.423800e-005],
    [2.148500e-001, 8.165200e-002, 1.691500e-005],
    [1.616100e-001, 6.100000e-002, 1.190600e-005],
    [1.182000e-001, 4.432700e-002, 8.148900e-006],
    [8.575300e-002, 3.200000e-002, 5.600600e-006],
    [6.307700e-002, 2.345400e-002, 3.954400e-006],
    [4.583400e-002, 1.700000e-002, 2.791200e-006],
    [3.205700e-002, 1.187200e-002, 1.917600e-006],
    [2.218700e-002, 8.210000e-003, 1.313500e-006],
    [1.561200e-002, 5.772300e-003, 9.151900e-007],
    [1.109800e-002, 4.102000e-003, 6.476700e-007]
]);

E1931_78 = np.array([ # 380 - 700
    [0.0001496284173324329, -0.0001512010236612619, 0.0004879574540342557],
    [0.0002948405566846667, -0.00029813994761045, 0.0009641626803456921],
    [0.0005969739329310309, -0.0006046724906690117, 0.001960784834866368],
    [0.001146945782897091, -0.001163546786410836, 0.003788477562505623],
    [0.002090266259752724, -0.002124920861282664, 0.006933977502889304],
    [0.003458971364661459, -0.003524318690010961, 0.01155935828305472],
    [0.00543213048370584, -0.005551734899228202, 0.01835665836701863],
    [0.008527574035064201, -0.008745096400383462, 0.02917829140316796],
    [0.01218719652868474, -0.01254802078991394, 0.04253532055632611],
    [0.01452354328407154, -0.01504080955108653, 0.05253171049209103],
    [0.01543637072057205, -0.01610200057310178, 0.05872989000782881],
    [0.01544750799845994, -0.01628634612531906, 0.06338017845658404],
    [0.01426273406179365, -0.01526054910936313, 0.06506267635122429],
    [0.01186011975679594, -0.01301842414291194, 0.06336841581197394],
    [0.008646816493985431, -0.009976696383157629, 0.05978815043052859],
    [0.005116712854028471, -0.00664242051626065, 0.05619858760049393],
    [0.001251326723859439, -0.002972086213655827, 0.05328536426287857],
    [-0.003202287155232748, 0.001329456581524942, 0.05152200141884338],
    [-0.008914359237981045, 0.007171502932120197, 0.04717979116733194],
    [-0.01506069389485542, 0.01380556810655221, 0.04080944244523332],
    [-0.0212188286221146, 0.0207978715166751, 0.0338116426307383],
    [-0.02733029268352749, 0.027984063950495, 0.02747954730973567],
    [-0.03339783124017649, 0.03547666636532135, 0.02234928470561239],
    [-0.04043555974562271, 0.04428437848569238, 0.01872323502095588],
    [-0.04883667960559386, 0.05490716886868416, 0.01641707139773943],
    [-0.05869881573851964, 0.06763420328352882, 0.01500061413219531],
    [-0.06900376199848271, 0.08163875594212226, 0.01386512358233661],
    [-0.07806252462867065, 0.0952099642271448, 0.01277712506433126],
    [-0.0843435132271167, 0.1065183210037817, 0.01183804186106326],
    [-0.08640920339832982, 0.1136484859182169, 0.01088900438964483],
    [-0.08452708253992496, 0.1167317141761939, 0.009694012851354671],
    [-0.08002467495686132, 0.1170170726524613, 0.008310674970737932],
    [-0.07293889114506759, 0.1145154207287711, 0.006739302392765375],
    [-0.06336891698008892, 0.109376168172342, 0.004983388966400278],
    [-0.05154260948185388, 0.1018807917398723, 0.003051109058488076],
    [-0.03760015280751908, 0.09222207690371496, 0.000931182031692128],
    [-0.02166882495439809, 0.08046167539979518, -0.0013763873141661],
    [-0.004022337219238535, 0.06673936298970794, -0.003846831170953794],
    [0.01487602859605807, 0.05143102678410408, -0.006425771887274515],
    [0.03442879791912283, 0.03502038357365685, -0.009038479445245093],
    [0.05384770601468025, 0.01810745958955519, -0.01158383219845547],
    [0.07218864364089167, 0.001434373836295911, -0.0139426281225841],
    [0.0885380878255987, -0.01416520891550778, -0.01599611213501072],
    [0.1020090241186127, -0.02789124615602601, -0.01762031703328261],
    [0.1111595037281677, -0.03862380469441987, -0.01862896737319595],
    [0.1162382895774413, -0.04647468983760769, -0.01905806930403166],
    [0.1165778349296999, -0.05086331574326712, -0.01882260720225655],
    [0.1129257715068756, -0.05223989123584105, -0.01802592762305127],
    [0.1052517045899909, -0.05069303223797276, -0.01666028152623697],
    [0.09413400068115792, -0.04665839237206323, -0.01480964300305627],
    [0.08174645146697553, -0.04138875357854586, -0.01280051393103628],
    [0.06975470789721455, -0.03591137569055827, -0.01088113059705021],
    [0.05817112773134336, -0.03033813806965957, -0.009046723362412494],
    [0.04716188173632588, -0.02484179131363488, -0.007317368330781207],
    [0.03726896067712073, -0.01977094019926495, -0.005772659222459686],
    [0.02885270788645798, -0.01538347228008408, -0.004463633866847281],
    [0.02175849321316427, -0.01163859066401756, -0.003363495681735876],
    [0.01595212138115972, -0.008558529802105716, -0.002464122175644567],
    [0.01159417854955085, -0.006234615647535821, -0.001789956931652925],
    [0.008539439810071906, -0.004599467332427692, -0.001317828158935075],
    [0.006210699803504581, -0.003348958010344955, -0.0009581856716769172],
    [0.004346253353448532, -0.002345209895415726, -0.0006704265569025207],
    [0.003008983410120751, -0.00162422691234037, -0.0004641054542580858],
    [0.002117911718920551, -0.001143651525168292, -0.0003266372488902393],
    [0.001505720674417754, -0.000813191362644736, -0.0002322132265649488]
]);

COMP_1 = np.array([3.4425, 3.4776, 3.5005, 3.5145, 3.5241, 3.5366, 3.5547, 3.5662, 3.5689, 3.5561, 3.5833, 3.6180, 3.6686, 3.8025, 3.9135, 3.9130, 3.9128, 3.9400, 3.9357, 4.0448, 4.1749, 4.4221, 4.5508, 4.7270, 4.8407, 4.8981, 4.9321, 4.9674, 5.0134, 5.0792, 5.1668, 5.2700, 5.3864, 5.5036, 5.6102, 5.7045, 5.7744, 5.8231, 5.8541, 5.9119])

COMP_2 = np.array([-0.8360, -0.8778, -0.9140, -0.9539, -0.9937, -1.0525, -1.1236, -1.2012, -1.2788, -1.3469, -1.3831, -1.3811, -1.3123, -1.1329, -0.9279, -0.7835, -0.6331, -0.4659, -0.2782, -0.0745, 0.1705, 0.4203, 0.6630, 0.8696, 1.0038, 1.0793, 1.1225, 1.1465, 1.1584, 1.1616, 1.1610, 1.1553, 1.1413, 1.1101, 1.0559, 0.9929, 0.9323, 0.8912, 0.8672, 0.8482])

COMP_3 = np.array([-0.7880, -0.7860, -0.7828, -0.7776, -0.7645, -0.7392, -0.7088, -0.6627, -0.5812, -0.4622, -0.2469, 0.0084, 0.2793, 0.6102, 0.8886, 1.0262, 1.0998, 1.1314, 1.1241, 1.1319, 1.0669, 1.0056, 0.7182, 0.4748, 0.2761, 0.1468, 0.0561, -0.0121, -0.0680, -0.1198, -0.1614, -0.1985, -0.2396, -0.2863, -0.3371, -0.3950, -0.4450, -0.4794, -0.5008, -0.5016])

COMP_4 = np.array([-0.1795, -0.2022, -0.2284, -0.2504, -0.2659, -0.2642, -0.2442, -0.2071, -0.1628, -0.1126, -0.0424, 0.0418, 0.1201, 0.2621, 0.4000, 0.4067, 0.3534, 0.2797, 0.2146, 0.0813, -0.0877, -0.1940, -0.3445, -0.3744, -0.3799, -0.3869, -0.3923, -0.3868, -0.3667, -0.3191, -0.2403, -0.1285, 0.0128, 0.1719, 0.3258, 0.4626, 0.5693, 0.6444, 0.6926, 0.7217])


def cohen_comps_to_380_700():
    xs = np.linspace(380, 770, 40)
    xs_prim = np.linspace(380, 700, 65)
    c1 = CubicSpline(xs, COMP_1, bc_type='natural')
    c2 = CubicSpline(xs, COMP_2, bc_type='natural')
    c3 = CubicSpline(xs, COMP_3, bc_type='natural')
    c4 = CubicSpline(xs, COMP_4, bc_type='natural')
    return np.vstack([c1(xs_prim), c2(xs_prim), c3(xs_prim), c4(xs_prim)])

COHEN_1964 = cohen_comps_to_380_700()

def fairman_v_to_400_700(a):
    xs = np.linspace(400, 700, 31)
    xsp = np.linspace(400, 700, 61)
    a1 = CubicSpline(xs, a[0], bc_type='natural')
    a2 = CubicSpline(xs, a[1], bc_type='natural')
    a3 = CubicSpline(xs, a[2], bc_type='natural')
    return np.stack([a1(xsp), a2(xsp), a3(xsp)]).transpose()

FAIRMAN_V = fairman_v_to_400_700(np.array([
   [ 0.0867, 0.1255, 0.1414, 0.1442, 0.1447, 0.1451, 0.1453, 0.1458, 0.1474, 0.1498, 0.1534, 0.1582, 0.1635, 0.1692, 0.1743, 0.1789, 0.1836, 0.1894, 0.1962, 0.2028, 0.2071, 0.2090, 0.2099, 0.2104, 0.2112, 0.2121, 0.2129, 0.2132, 0.2133, 0.2133, 0.2136 ],
   [ -0.1027, -0.1527, -0.1778, -0.1885, -0.1972, -0.2069, -0.2166, -0.2260, -0.2337, -0.2354, -0.2296, -0.2163, -0.1942, -0.1658, -0.1357, -0.1043, -0.0668, -0.0230, 0.0249, 0.0737, 0.1172, 0.1515, 0.1753, 0.1896, 0.1974, 0.2025, 0.2055, 0.2077, 0.2099, 0.2125, 0.2152 ],
   [ 0.1443, 0.2060, 0.2307, 0.2302, 0.2218, 0.2087, 0.1885, 0.1590, 0.1150, 0.0558, -0.0181, -0.0992, -0.1773, -0.2426, -0.2854, -0.3057, -0.3083, -0.2914, -0.2497, -0.1850, -0.1099, -0.0415, 0.0097, 0.0444, 0.0707, 0.0949, 0.1142, 0.1252, 0.1293, 0.1294, 0.1292 ]
]))

def fairman_v0_to_400_700(a):
    xs = np.linspace(400, 700, 31)
    xsp = np.linspace(400, 700, 61)
    a = CubicSpline(xs, a, bc_type='natural')
    return a(xsp).transpose()

FAIRMAN_V0 = fairman_v0_to_400_700([ 18.76, 23.10, 24.72, 25.14, 25.51, 25.96, 26.40, 26.96, 27.66, 28.34, 29.05, 29.82, 30.51, 31.09, 31.41, 31.45, 31.53, 31.95, 32.79, 33.74, 34.49, 35.04, 35.54, 35.93, 36.30, 36.73, 37.25, 37.76, 38.25, 38.70, 39.13 ])
